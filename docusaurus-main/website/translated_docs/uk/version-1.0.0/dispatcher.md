---
id: version-1.0.0-dispatcher
title: Specification for the interaction of the merchant with the Dispatcher software.
original_id: dispatcher
---

## Оплата на платіжній сторінці процесингу

Для оплати на платіжній сторінці необхідно виконати редирект на сторінку, з даними POST.

**Production url:**   https://pay.concord.ua/api/

POST параметри:
 
| Параметр     | Опис                                                                                                                                                                          | Значення        |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
| operation    | Тип операції                                                                                                                                                                      | Purchase        |
| merchant_id  | ID мерчанта                                                                                                                                                |                 |
| amount       | Сума операції. Приклад: 500.00                                                                                                                                                     |                 |
| signature    | З метою підтвердження валідності даних повинен бути згенерований і переданий в запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                        |                 |
|              | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (крапка з комою) в кодуванні UTF-8. |                 |
|              | Порядок параметрів при конкатенації важливий!                                                                                                                                        |                 |
| order_id     | Унікальний номер операції на стороні мерчанта. Якщо операція дублюється - мерчант отримує помилку.                                                                              |                 |
| currency_iso | Валюта платежу.                                                                                                                                                                   | UAH             |
| description  | Призначення платежу. Виводиться на платіжній сторінці, при введенні платіжних реквізитів. Відображається у виписці за рахунком і реєстрах                                                   |                 |
| add_params   |Масив з додатковими параметрами. Розширені можливості пошуку потім повертаються мерчанту в callback виклику                                                                     |                 |
| approve_url  | URL для переадресації у разі, якщо платіж успішний                                                                                                                             |                 |
| decline_url  | URL для переадресації у разі, якщо платежі не успішний                                                                                                                            |                 |
| cancel_url   | URL для переадресації у разі, якщо користувач відмовився зробити оплату                                                                                                      |                 |
| callback_url | URL, на який прийде інформація про результат виконання платежу                                                                                                                 |                 |
| redirect     | true / false - за замовчуванням true, якщо параметр у значенні true, тоді клієнт не отримуватиме переадресацію, а отримає url платіжної сторінки                                          | Не обов'язковий |
| auth_type    | За замовчуванням 1 - покупка, 2- попередня авторізація                                                                                                                                       | Не обов'язковий |
| language     | За замовчуванням ua - українська, ru - російська, en - англійська   | Не обов'язковий |
| client_first_name    | Ім'я клієнта  | Не обов'язковий |
| client_last_name | Прізвище клієнта  | Не обов'язковий |
| client_id | Ідентифікатор клієнта у системі мерчанта  | Не обов'язковий |
| phone | Телефон клієнта  | Не обов'язковий |
| email | Адреса електронної пошти клієнта  | Не обов'язковий |


## Callback виклик для відправки повідомлення про статус платежу


Дані надсилаються за URL-адресою, яка вказана в параметрах платежу в полі callback_url.


Дані надсилаються на сервер мерчанта в форматі JSON.


Параметри:


| Назва параметру | Опис                                                                                                                                                                | Значення           |
|--------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
| merchantAccount    | ID мерчанта                                                                                                                                                             |                    |
| orderReference     | ID операції в системі мерчанта                                                                                                                                          |                    |
| amount             | Сума операції                                                                                                                                                          |                    |
| currency           | Валюта операції                                                                                                                                                         |                    |
| phone              | Номер телефону клієнта (якщо увімкнуте введення телефону на платіжній сторінці)                                                                                                |                    |
| createdDate        | Дата платежу в форматі YYYY-MM-DD HH:II:SS                                                                                                                              |                    |
|                    | Приклад: 2018-12-14 12:01:26                                                                                                                                             |                    |
| cardPan            | Маскувати PAN картки.                                                                                                                                               |                    |
|                    | Приклад: 535277******0298                                                                                                                                                |                    |
| cardType           | Тип картки                                                                                                                                                             | Visa               |
|                    |                                                                                                                                                                         | MasterCard         |
| fee                | Комісія за операцію                                                                                                                                                   |                    |
| transactionId      | ID транзакції на стороні ПЦ                                                                                                                                             |                    |
| type               | Тип операції. На даний момент параметр не використовується                                                                                                                 |                    |
| recToken           |Токен для рекурентного платежу                                                                                                                                         |                    |
| transactionStatus  | Статус операції                                                                                                                                                         | Approved - Успішно / Declined - Відмова|
| reason             | Текстова причина відмови                                                                                                                                                |                    |
| reasonCode         | Код помилки при відмові                                                                                                                                                |                    |
| merchantSignature  | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                |                    |
|                    | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, orderReference, amount, currency розділених ";" (крапка з комою) в кодуванні UTF-8. |                    |
|                    | **Порядок параметрів при конкатенації важливий!**                                                                                                                              |                    |


## Рекурентні платежі RecPayment (оплата за токеном)

**Production url:**   https://pay.concord.ua/api/


Для здійснення рекурентного платежу необхідно надіслати POST-запит з наступними параметрами:

| Назва        | Опис                                                                                                                                                                                          |
|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| operation       |  Необхідне значення для даної операції RecPayment                                                                                                                                              |
| merchant_id     | Ідентифікатор мерчанта                                                                                                                                                                            |
| amount          | Сума операції. Приклад: 500.00                                                                                                                                                                    |
| recurring_token | Токен, отриманий від ПС                                                                                                                                                                            |
| order_id        | Унікальний номер замовлення в системі мерчанта                                                                                                                                                       |
| description     | Призначення платежу                                                                                                                                                                               |
| currency_iso    | Валюта. На даний момент тільки UAH                                                                                                                                                               |
| auth_type       | 1 - покупка, 2 - попередня авторізація. Не обов'язковий. За замовчуванням - 1                                                                                                                               |
| signature       | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                                         |
|                 |Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, recurring_token, currency_iso, description розділених ";" (крапка з комою) в кодуванні UTF-8. |
|                 | **Порядок параметрів при конкатенації важливий!**                                                                                                                                                        |

У відповідь надходять наступні параметри:

| Назва | Параметри                      |
|----------|--------------------------------|
| status   | APPROVED - успішно,            |
|          | DECLINED - операція не успішна|
| code     | Код відповіді                     |

## Операція Verify

Для перевірки картки необхідно переадресувати користувача на сторінку платіжного шлюзу методом POST з наступними параметрами:

| Назва | Опис                                                                                                                                                                                  | Тип     |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| operation     | Тип операції “Verify”                                                                                                                                                                       | String  |
| merchant_id   | Ідентифікатор мерчанта                                                                                                                                                                     | String  |
| order_id      | Унікальний номер операції. Генерується на стороні мерчанта. Він повинен бути унікальним протягом всієї роботи.                                                                       | Integer |
| approve_url   | URL, на який буде перенаправлений користувач у разі успішної операції                                                                                                                  | String  |
| decline_url   | URL, на який буде перенаправлений користувач у разі не успішної операції                                                                                                               | String  |
| cancel_url    | URL, на який буде перенаправлений користувач у разі скасування операції                                                                                                                    | String  |
| signature     | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                                   | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, approve_url, decline_url, cancel_url розділених ";" (крапка з комою) в кодуванні UTF-8.|         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                                                                  |         |

## Операція Reversal
Для відміни платежу необхідно надіслати POST-запит на url https://pay.concord.ua/api/reversal з наступними параметрами:

| Назва | Опис                                                                                                                                                 | Тип     |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| merchant_id   | Ідентифікатор мерчанта                                                                                                                                   | String  |
| order_id      | Унікальний номер операції, яка була відправлена ​​в запиті P2PCredit, P2PDebit або Verify                                                            | Integer |
| signature     | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта. | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id розділених ";" (крапка з комою) в кодуванні UTF-8.     |         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                               |         |

У відповідь повертається JSON з наступними параметрами:

| Назва | Опис                                   | Тип     |
|---------------|--------------------------------------------|---------|
| code          |Код відповіді. (Список кодів відповіді див. нижче) | Integer |
| message       | Текстове повідомлення з результатом запиту  | String  |

## Операція Complete
Для підтвердження платежу необхідно надіслати POST запит на url https://pay.concord.ua/api з наступними параметрами:

| Назва | Опис                                                                                                                                                     | Тип     |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| merchant_id   | Ідентифікатор мерчанта                                                                                                                                       | String  |
| operation     | Complete                                                                                                                                                     | String  |
| order_id      | Унікальний номер операції, яка була відправлена ​​в запиті Purchase                                                                                     | Integer |
| amount        | Сума списання                                                                                                                                               |  float  |
| signature     | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.     | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount розділених ";" (крапка з комою) в кодуванні UTF-8. |         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                                  |         |


У відповідь повертається JSON з наступними параметрами:

| Назва | Опис                                   | Тип     |
|---------------|--------------------------------------------|---------|
| code          | Код відповіді. (Список кодів відповіді див. нижче) | Integer |
| message       | Текстове повідомлення з результатом запиту | String  |


## Операція Check

Для перевірки статусу платежу необхідно надіслати POST-запит на url https://pay.concord.ua/api/check з наступними параметрами:

| Назва | Опис                                                                                                                                                | Тип     |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| merchant_id   | Ідентифікатор мерчанта                                                                                                                                   | String  |
| order_id      | Унікальний номер операції, яка була відправлена ​​в запиті P2PCredit, P2PDebit або Verify                                                            | Integer |
| signature     | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольна підпис з використанням SecretKey мерчанта. | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id розділених ";" (крапка з комою) в кодуванні UTF-8.      |         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                               |         |


У відповідь повертається JSON з наступними параметрами:

| Назва   | Опис                                   | Тип        |
|-------------------|--------------------------------------------|------------|
| reasoneCode       | Код відповіді. (Список кодів відповіді див. нижче) | Integer    |
| reason            | Опис відповіді                           | String     |
| merchantAccount   | Мерчант                                    | String     |
| amount            | Сума                                      | String     |
| phone             | Номер телефону                            | String     |
| createdDate       | Дата платежу                               | String     |
| cardPan           | Маскований номер картки                  | String     |
| cardType          | Тип картки                                  | String     |
| transactionId     | Ідентифікатор транзакції                   | BigInteger |
| message           | Текстове повідомлення з результатом запиту  | String     |
| datetime          | Дата створення операції на сервері          | String     |
| fee               | Комісія платежу                           | Double     |
| transactionStatus | Статус операції (Довідник дів. нижче)        | String     |

## Операція P2PCredit
Для поповнення картки необхідно надіслати POST-запит з наступними параметрами:

| Назва | Опис                                                                                                                                                                             | Тип    |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|
| operation     | Тип операції “P2PCredit”                                                                                                                                                             | String |
| merchant_id   | Ідентифікатор мерчанта                                                                                                                                                               | String |
| order_id      | Унікальний номер операції. Генерується на стороні мерчанта. Він повинен бути унікальним протягом всієї роботи.                                                                | String |
| amount        | Сума операції, повинна бути дробовим числом, з двома знаками після коми. Приклад: 100.50                                                                                          | Double |
| card_number   | Номер картки одержувача.                                                                                                                                                              | String |
| token         | Токен, можна використовувати замість картки одержувача                                                                                                                                    | String |
| currency_iso  | Валюта операції. На даний момент доступна тільки "UAH"                                                                                                                              | String |
| visa_alias	| Замість номера картки чи токена можна вказати дані псевдоніма VisaAlias <br> Якщо номер телефону використовується як псевдонім, він повинен бути наданий відповідно до структури номера ITU-T E.164 (2010). <br>Приклад (номер телефону): 380670000000	| String |
| visa_alias_type | Тип аліасу. Обов'язковий, якщо вказано параметр visa_alias.	| String |
| signature     | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                             | String |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, card_number, currency_iso розділених ";" (крапка з комою) в кодуванні UTF-8. |        |
|               |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                           |        |

Можливі значення параметра visa_alias_type:
   - 01 – номер телефону,
   - 02 - адреса електронної пошти,
   - 03 - національний ідентифікатор,
   - 04 - IBAN (міжнародний номер банківського рахунку)

Інформацію про передачу додаткових полів для ідентифікації відправника та одержувача переказів можна знайти у відповідному довіднику.

У відповідь повертається JSON з наступними параметрами:

|  Назва | Опис                                                                              | Тип     |
|---------------|---------------------------------------------------------------------------------------|---------|
| code          | Код відповіді                     | Integer |
| message       | Текстове повідомлення з результатом запиту                                             | String  |
| status        | Статуси операції                                                                      | String  |
|               | APPROVED - переказ  успішний                                                            |         |
|               | DECLINED - переказ не успішний                                                        |         |
|               | ON-PAYMENT - заявка на переказ  в обробці, необхідно додатково запросити статус |         |
| transactionID | Ідентифікатор транзакції в платіжній системі                                         | Integer |
| approvalCode  | Код авторизації                                                                       | Integer |

## Операція отримання балансу (GetBalance)

Для отримання балансу картки необхідно надіслати на url https://pay.concord.ua/api/balance POST-запит з наступними параметрами:
| Назва | Опис                                                                                                                                                 | Тип    |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|--------|
| operation     | Тип операції "GetBalance"                                                                                                                               | String |
| merchant_id   | Ідентифікатор мерчанта                                                                                                                                   | String |
| date          | Дата та час запиту в довільному форматі                                                                                                              | String |
| signature     | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта. | String |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, data розділених ";" (крапка з комою) в кодуванні UTF-8.         |        |
|               | Порядок параметрів при конкатенації важливий!                                                                                                               |        |

У відповідь повертається JSON з наступними параметрами:

| Назва | Опис                     | Тип   |
|----------------|------------------------------|-------|
| mk_deposit     | Лiмiт Mastercard             | Float |
| visa_deposit   | Лiмiт Visa                   | Float |
| mk_available   | Доступний залишок Mastercard | Float |
| visa_available | Доступний залишок Visa       | Float |

## Операція P2PDebit
Для списання коштів з картки необхідно переадресувати користувача на сторінку платіжного шлюзу методом POST з наступними параметрами:

| Назва | Опис                                                                                                                                                                                                             | Тип     |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| operation     | Тип операції "P2PDebit"                                                                                                                                                                                             | String  |
| merchant_id   | Ідентифікатор мерчанта                                                                                                                                                                                               | String  |
| order_id      | Унікальний номер операції. Генерується на стороні мерчанта. Він повинен бути унікальним протягом всієї роботи.                                                                                                | Integer |
| amount        | Сума операції, повинна бути дробовим числом, з двома знаками після коми. Приклад: 100.50                                                                                                                            | Double  |
| currency_iso  | Валюта операції. На даний момент доступна тільки "UAH"                                                                                                                                                             | String  |
| description   | Призначення платежу                                                                                                                                                                                                   | String  |
| approve_url   | URL, на який буде перенаправлений користувач в разі успішної операції                                                                                                                                           | String  |
| decline_url   | URL, на який буде перенаправлений користувач в разі не успішної операції                                                                                                                                        | String  |
| cancel_url    | URL, на який буде перенаправлений користувач в разі скасування операції                                                                                                                                             | String  |
| signature     | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                                                             | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description, approve_url, decline_url, cancel_url розділених ";" (крапка з комою) в кодуванні UTF-8. |         |
|               |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                                                              |         |


Інформацію про передачу додаткових полів для ідентифікації відправника та одержувача переказів можна знайти у відповідному довіднику.

## Операція PurchaseOnMerchant
Для оплати на платіжній сторінці мерчанта необхідно відправити POST-запит з наступними даними.


**Production url:**   https://pay.concord.ua/api/

POST-параметри:

|       Параметр         |       Опис                                                                                                                                                                            |           Значення         |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
| operation      | Тип операції                                                                                                                                                                      | PurchaseOnMerchant |
| merchant_id    | ID мерчанта                                                                                                                                                |                    |
| amount         | Сума операції. Приклад: 500.00                                                                                                                                                     |                    |
| signature      | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                          |                    |
|                | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (крапка з комою) в кодуванні UTF-8. |                    |
|                | Порядок параметрів при конкатенації важливий!                                                                                                                                        |                    |
| order_id       | Унікальний номер операції на стороні мерчанта. Якщо операція дублюється - мерчант отримує помилку.                                                                              |                    |
| currency_iso   | Валюта платежу.                                                                                                                                                                   | UAH                |
| description    | Призначення платежу. Виводиться на платіжній сторінці, при введенні платіжних реквізитів. Відображається в виписці за рахунком і реєстрах                                                   |                    |
| add_params     | Масив з додатковими параметрами. Розширені можливості пошуку потім повертаються мерчанту в callback виклику                                                                      |                    |
| token          | Токен для списання з картки без передачі реквізитів картки                                                                                                                         |                    |
| card_num       | Номер картки                                                                                                                                                                      |                    |
| card_exp_month | Термін дії картки MM                                                                                                                                                         |                    |
| card_exp_year  | Термін дії картки YY                                                                                                                                                           |                    |
| card_cvv       | CVV2 код, у разі операції без CVV необхідно вказати -1                                                                                                                         |                    |
| card_holder    | Власник картки. Необов'язкове поле                                                                                                                                             |                    |
| phone          | Номер телефону клієнта. Необов'язкове поле                                                                                                                                      |                    |
| payment_type   | Тип платежу                                                                                                                                                                      |                    |
|                | Purchase - покупка                                                                                                                                                                |                    |
|                | PreAuth - блокування коштів на картці                                                                                                                                      |                    |
| secure_type    | Тип проходження безпеки транзакції                                                                                                                                           |                    |
|                | Може приймати наступні значення:                                                                                                                                              |                    |
|                | Auto                                                                                                                                                                              |                    |
|                | 3DS                                                                                                                                                                               |                    |
|                | Non3DS                                                                                                                                                                            |                    |
| callback_url   | URL, на який прийде інформація про результат виконання платежу                                                                                                                 |                    |

Відповідь:

|    Параметр             |       Опис                                                                      |        Значення                      |
|-----------------|------------------------------------------------------------------------------|------------------------------|
| status          | Статус платежу                                                               | Довідник "Статуси платежу" |
| code            | Код відповіді                                                                 | Довідник "Коди відповідей"    |
| order_id        | Унікальний номер замовлення в системі мерчанта                                  |                              |
| amount          | Сума платежу                                                                |                              |
| fee             | Комісія                                                                    |                              |
| currency        | Валюта платежу                                                               |                              |
| token           | Токен для подальших оплат. Токен повернеться у разі успішного платежу    |                              |
| d3_acs_url      | URL ACS-сервера, на який необхідно відправити користувача для верифікації |                              |
| d3_md           |Унікальний ідентифікатор, який необхідно передати на ACS-сервер          |                              |
| d3_pareq        | Запит, який необхідно передати на ACS-сервер                             |                              |
| transaction_key | Ключ транзакції, який необхідно використовувати для підтвердження платежу   |                              |
| transaction_id  | Iдентифікатор транзакції                                                     |                              |
| signature       |                                                                              |                              |

Якщо у відповіді code прийшло значення 2001, необхідно провести перевірку 3DS.

Для перевірки 3DS необхідно методом POST надіслати форму з параметрами d3_md, d3_pareq, term_url на d3_acs_url.


term_url - URL, на який повернеться результат перевірки 3DS.

``` html
<form name="MPIform" action='${d3_acs_url}' method="POST">
<input type="hidden" name="PaReq" value='${d3_pareq }'>
<input type="hidden" name="MD" value='${d3_md }'>
<input type="hidden" name="TermUrl" value='${term_url}'>
</form>
```

## Отримання токену для Masterpass
**Production url:**  https://pay.concord.ua/api/mptoken

Для отримання гостьового токену необхідно надіслати POST-запит з наступними даними:
| Параметр  | Опис                                                           |
|-----------|----------------------------------------------------------------------|
| msisdn    | Номер телефону для входу в гаманець Masterpass в форматі 380XXXXXXXXX|
| client_id | Ідентифікатор клієнта в системі MasterPass                           |



У відповідь приходить об'єкт в форматі JSON з наступними параметрами:

| Параметр     | Опис                            |
|--------------|-------------------------------------|
| res          | Результат запиту 0 - успіх        |
| msg          |Повідомлення про помилку                 |
| token        | Токен для передачі в mfs бібліотеку |
| reference_no | Унікальний номер запиту           |

## Проведення платежу через Masterpass

**Production url:**  https://pay.concord.ua/api

Для отримання гостьового токену необхідно надіслати POST-запит з наступними даними:

| Параметр               | Опис                                                                                                                                                                        | Значение           |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
| operation              | Тип операції                                                                                                                                                                      | PurchaseMasterpass |
| merchant_id            | Ідентифікатор мерчанта                                                                                                                                                            |                    |
| amount                 | Сума платежу в форматі 1.00                                                                                                                                                    |                    |
| order_id               |                                                                                                                                                                                   |                    |
| currency_iso           | Валюта                                                                                                                                                                            | UAH                |
| description            | Опис платежу                                                                                                                                                                |                    |
| approve_url            | URL для переадресації після успішного платежу (в разі підтвердження 3DS на сторінці ConcordPay)                                                                                 |                    |
| decline_url            | URL для переадресації потім не успішного платежу (в разі підтвердження 3DS на сторінці ConcordPay)                                                                              |                    |
| cancel_url             | URL для переадресації після скасування платежу (в разі підтвердження 3DS на сторінці ConcordPay)                                                                                   |                    |
| callback_url           | URL, на який буде відправлений callback про статус платежу                                                                                                                         |                    |
| add_params[wallet]     | Ознака гаманця                                                                                                                                                                 | masterpass         |
| add_params[msisdn]     | Номер телефону для входу в гаманець Masterpass в форматі 380XXXXXXXXX                                                                                                             |                    |
| add_params[token]      | Токен, що отриманий з сервера MasterPass                                                                                                                                            |                    |
| add_params[card_name]  | Alias ​​карти, що отриманий з сервера MasterPass                                                                                                                                       |                    |
| add_params[client_id]  | Ідентифікатор мерчанта в системі MasterPass                                                                                                                                       |                    |
| add_params[ret_ref_no] | Унікальний номер транзакції, що отриманий з сервера MasterPass                                                                                                                       |                    |
| signature              | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                          |                    |
|                        | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (крапка з комою) в кодуванні UTF-8. |                    |
|                        |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                           |                    |


У відповідь приходить об'єкт в форматі JSON з наступними параметрами:

Якщо транзакція вимагає підтвердження 3DS:

| Параметр        | Опис                                                                                                                                                                                                                                    |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| code            | Код відповіді                                                                                                                                                                                                                                    |
| status          | Статус транзакції. Якщо необхідна перевірка 3DS, в статусі буде значення 3ds                                                                                                                                                              |
| d3AcsUrl        | URL для перенаправлення клієнта для перевірки 3DS                                                                                                                                                                                            |
| d3Md            | Криптограма для передачі на хост 3DS                                                                                                                                                                                                         |
| d3Pareq         | Запит для передачі на хост 3DS                                                                                                                                                                                                               |
| transaction_key |Ключ транзакції для підтвердження 3DS                                                                                                                                                                                                         |
| TermUrl         | URL для переадресації після введення коду підтвердження на сторінці 3DS. За замовчуванням URL на сторінку ConcordPay, для перевірки 3DS можна вказати свій URL, тоді після проходження 3DS необхідно викликати метод "Підтвердження 3DS верифікації" |

## Підтвердження 3DS верифікації

Для оплати на платіжній сторінці мерчанта необхідно відправити POST запит з наступними даними.

**Production url:**   https://pay.concord.ua/api/

| Параметр        | Опис                                                                                                                                                                    | Значення   |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| operation       | Тип операції                                                                                                                                                                | Complete3DS |
| transaction_key | Ключ транзакції                                                                                                                                                             |             |
| merchant_id     | Ідентифікатор мерчанта                                                                                                                                                      |             |
| d3ds_md         | Ідентифікатор, що отриманий після редиректу з ACS-сервера                                                                                                                       |             |
| d3ds_pares      | Повідомлення, що отримане після редиректу з ACS-сервера                                                                                                                          |             |
| signature       | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                    |             |
|                 | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, transaction_key, d3ds_md, d3ds_pares розділених ";" (крапка з комою) в кодуванні UTF-8. |             |
|                 |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                 |             |

Відповідь

| Параметр       | Опис                                   | Значення                    |
|----------------|--------------------------------------------|------------------------------|
| status         | Статус платежу                             | довідник “Статуси платежу” |
| code           | Код відповіді                                 | довідник “Коди відповідей”    |
| order_id       | Унікальний номер замовлення в системі мерчанта |                              |
| amount         | Сума платежу                              |                              |
| fee            | Комісія                                   |                              |
| currency       | Валюта платежу                             |                              |
| card_pan       | Маскуваний номер картки                  |                              |
| transaction_id | Iдентифікатор транзакції                   |                              |

## Оплата на платіжній сторінці процесингу з розщепленням платежу

Для оплати на платіжній сторінці процесингу необхідно виконати редирект на сторінку процесингового центру, з POST даними.

**Production url:**   https://pay.concord.ua/api/

POST параметри:

|     Параметр         |        Опис                                                                                                                                                                                               | Значення          |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
| operation    | Тип операції                                                                                                                                                                                                      | Purchase          |
| merchant_id  | ID мерчанта                                                                                                                                                                             |                   |
| amount       | Сума операції. Приклад: 500.00                                                                                                                                                                                     |                   |
| signature    | З метою підтвердження валідності даних повинен бути згенерований і переданий у запиті HMAC_MD5 контрольний підпис з використанням SecretKey мерчанта.                                                          |                   |
|              | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (крапка з комою) в кодуванні UTF-8.                                |                   |
|              | Порядок параметрів при конкатенації важливий!                                                                                                                                                                        |                   |
| order_id     | Унікальний номер операції на стороні мерчанта. Якщо операція дублюється - мерчант отримує помилку.                                                                                                              |                   |
| currency_iso | Валюта платежу.                                                                                                                                                                                                   | UAH               |
| description  | Призначення платежу. Виводиться на платіжній сторінці, при введенні платіжних реквізитів. Відображається в виписці за рахунком і реєстрах                                                                                 |                   |
| add_params   | Масив з додатковими параметрами. Розширені можливості пошуку потім повертаються мерчанту в callback виклику                                                                                                      |                   |
| split        | Ознака розщеплення платежу                                                                                                                                                                                       | 0 - не розщеплювати |
|              |                                                                                                                                                                                                                   | 1 - розщеплювати   |
| split_rules  | Масив з правилами розщеплення, який містить в собі ідентифікатори субмерчанта і суми.                                                                                                                       |                   |
|              | Сума розщеплення повинна збігатися з сумою платежу.                                                                                                                                                              |                   |
|              | Приклад:                                                                                                                                                                                                           |                   |
|              | split_rules[0][sub_merchant_id]=test1&split_rules[0][amount]=100.00&split_rules[1][sub_merchant_id]=test2&split_rules[1][amount]=50.00&.......&split_rules[n][sub_merchant_id]=testn&split_rules[n][amount]=10.00 |                   |
| approve_url  | URL для переадресації у разі, якщо платіж успішний                                                                                                                                                               |                   |
| decline_url  | URL для переадресації у разі, якщо платежі не успішний                                                                                                                                                            |                   |
| cancel_url   | URL для переадресації у разі, якщо користувач відмовився зробити оплату                                                                                                                                      |                   |
| callback_url | URL, на який прийде інформація про результат виконання платежу                                                                                                                                                 |                   |


## Отримання даних про діапазон карток
Для отримання даних про діапазон карток необхідно надіслати POST-запит  на url https://pay.concord.ua/api/bas з наступними параметрами:

| Параметр | Опис | Значення |
|-----------------|----------|-------------|
| merchant_id | Ідентифікатор мерчанта | String|
| range | Перші кілька цифр номер картки, на яку здійснюється пошук діапазону. Пошук здійснюється за першими 9 цифрами номера картки. Якщо передано менше 9 цифр, то номер буде доповнений нулями. Якщо передано більше, то пошук здійснюється за першими 9 | String |
| signature | З метою підтвердження валідності даних має бути згенерований та переданий у запиті HMAC_MD5 контрольний підпис із використанням SecretKey мерчанта. | String |
| | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, range розділених “;” (крапка з комою) у кодуванні UTF-8. | |
| | Порядок параметрів при конкатенації є важливим! | |

У відповідь повертається JSON з наступними параметрами (набір полів залежить від доступного пакету мерчанту):
 
| Назва поля | Опис | Тип | Level 1 (Base) | Level 2 (Full) |
|------------|----------|--------|--------|--------|
| code | Error code. If 0 - успіх | Integer | X | X |
| message | Error message in case where code > 0 | String | X | X |
| minRange | Account Range Minimum | Integer | X | X |
| maxRange | Account Range Maximum | Integer | X | X |
| brandCd | Brand Indicator | String | X | X |
| issuerBin | Issuer BIN | String | X | X |
| binLength | BIN Length | String | X | X |
| sharedBinInd | Shared BIN Indicator | String | X | X |
| posdomesticOnlyInd | Domestic-Use-Only Flag | String | X | X |
| onlineGamblBlockInd | Online Gambling Block | String | X | X |
| binRangePaymentAccountType | Token Indicator | String | X | X |
| issuerBillingCurrCd | Issuer Billing Currency | String | | X |
| accountCtryAlpha2Code | Issuer Country Code | String | | X |
| platformCd | Product Platform | String | | X |
| productId | Product ID | String | | X |
| productIdName | Product Name | String | | X |
| accountFundingSourceCd | Account Funding Source | String | | X |
| accountFundingSourceSubtypeCd | Account Funding Source Subtype | String | | X |
| accuntBusName | Issuer Name | String | | X |
                      
Коди помилок
| Код помилки | Опис |
|-----------------|----------|
| 0 | Success |
| 1 | Merchant not found |
| 2 | Wrong signature |
| 3 | Wrong field format |
| 5 | Data not found |